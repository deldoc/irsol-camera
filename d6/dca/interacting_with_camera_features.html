<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IRSOL: 02-interacting-with-camera-features</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../irsol_logo.jpeg"/></td>
  <td id="projectalign">
   <div id="projectname">IRSOL
   </div>
   <div id="projectbrief">C++ code implementing socket server for interacting with Baumer camera.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d6/dca/interacting_with_camera_features.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">02-interacting-with-camera-features</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example serves as as a playground for understanding how to control the parameters of the <em>Baumer</em> camera via the <code><a class="el" href="../../d7/d37/classirsol_1_1camera_1_1Interface.html" title="High-level wrapper around the NeoAPI camera for synchronized access.">irsol::camera::Interface</a></code> class.</p>
<h1>Camera Parameter Interface</h1>
<p>The <code><a class="el" href="../../d7/d37/classirsol_1_1camera_1_1Interface.html" title="High-level wrapper around the NeoAPI camera for synchronized access.">irsol::camera::Interface</a></code> class provides a convenient abstraction over <code>NeoAPI</code>'s camera control system. It simplifies getting and setting camera parameters while ensuring thread safety and proper type conversion. This section explains the design and usage of its parameter management functions.</p>
<h2><code>getParam</code></h2>
<p><code>getParam</code> is a templated method used to retrieve the value of a camera feature by name. It is type-safe and automatically deduces the correct underlying <code>NeoAPI</code> getter based on the requested C++ type. </p><div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">T Interface::getParam(<span class="keyword">const</span> std::string&amp; param) <span class="keyword">const</span>;</div>
</div><!-- fragment --><p>Supported types:</p><ul>
<li><code>int</code>, <code>int64_t</code> – for integer-based parameters</li>
<li><code>double</code>, <code>float</code> – for floating-point parameters</li>
<li><code>std::string</code> – for string-valued parameters</li>
<li><code>bool</code> – for boolean switches</li>
</ul>
<p>Example usage: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> width = interface.getParam&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;Width&quot;</span>);</div>
<div class="line">std::string pixelFormat = interface.getParam&lt;std::string&gt;(<span class="stringliteral">&quot;PixelFormat&quot;</span>);</div>
</div><!-- fragment --><p>If a parameter fetch fails, the function logs the error and returns a default-constructed value (e.g., 0 for integers, "Unknown" for strings).</p>
<h2><code>setParam</code></h2>
<p><code>setParam</code> is a templated, thread-safe setter that assigns a value to a camera feature, then reads back and returns the applied value to confirm the update. </p><div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">T Interface::setParam(<span class="keyword">const</span> std::string&amp; param, T <a class="code hl_variable" href="../../d6/d3f/test__assignment_8cpp.html#a442505a4bcabcf16de33fdf0b96c02ce">value</a>);</div>
<div class="ttc" id="atest__assignment_8cpp_html_a442505a4bcabcf16de33fdf0b96c02ce"><div class="ttname"><a href="../../d6/d3f/test__assignment_8cpp.html#a442505a4bcabcf16de33fdf0b96c02ce">value</a></div><div class="ttdeci">auto value</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d3f/test__assignment_8cpp_source.html#l00031">test_assignment.cpp:31</a></div></div>
</div><!-- fragment --><p>This method ensures:</p><ul>
<li>Type safety: Automatically chooses the correct <code>NeoAPI</code> setter.</li>
<li>Thread safety: Uses a mutex lock to protect access to the shared camera handle.</li>
<li>Error handling: Logs detailed errors and verifies write capability.</li>
</ul>
<p>Example usage: </p><div class="fragment"><div class="line">interface.setParam(<span class="stringliteral">&quot;ExposureAuto&quot;</span>, <span class="stringliteral">&quot;Off&quot;</span>);</div>
<div class="line">interface.setParam(<span class="stringliteral">&quot;Width&quot;</span>, 2048);</div>
</div><!-- fragment --><h3>Note on <code>setParam</code> behavior</h3>
<p>When using the <code>setParam</code> methods to configure camera parameters, it's important to understand that the value ultimately applied by the camera may differ slightly from the one provided. This is because some camera features accept only specific discrete values, or impose constraints such as value ranges or fixed precision steps. For example, setting an exposure time of <code>1037µs</code> may result in the camera applying <code>1040µs</code> if that's the closest supported value. To ensure the caller is aware of the actual value in effect, all <code>setParam</code> overloads return the final value that was accepted by the camera after attempting the update.</p>
<div class="fragment"><div class="line"><span class="comment">// Attempt to set exposure time to 1037 microseconds</span></div>
<div class="line"><span class="keyword">auto</span> requestedExposure = std::chrono::microseconds(1037);</div>
<div class="line"><span class="keyword">auto</span> appliedExposure = cam.setExposure(requestedExposure);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="../../d0/da9/logging_8hpp.html#a2c8ae9f0bc88357231bbe3c8e885103f">IRSOL_LOG_INFO</a>(<span class="stringliteral">&quot;Requested exposure: {}&quot;</span>, <a class="code hl_function" href="../../d8/d93/namespaceirsol_1_1utils.html#af2468710608c92085f4771001ea3a105">irsol::utils::durationToString</a>(requestedExposure));</div>
<div class="line"><a class="code hl_define" href="../../d0/da9/logging_8hpp.html#a2c8ae9f0bc88357231bbe3c8e885103f">IRSOL_LOG_INFO</a>(<span class="stringliteral">&quot;Applied exposure: {}&quot;</span>, <a class="code hl_function" href="../../d8/d93/namespaceirsol_1_1utils.html#af2468710608c92085f4771001ea3a105">irsol::utils::durationToString</a>(appliedExposure));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Output might be:</span></div>
<div class="line"><span class="comment">// Requested exposure: 1037 µs</span></div>
<div class="line"><span class="comment">// Applied exposure: 1040 µs</span></div>
<div class="ttc" id="alogging_8hpp_html_a2c8ae9f0bc88357231bbe3c8e885103f"><div class="ttname"><a href="../../d0/da9/logging_8hpp.html#a2c8ae9f0bc88357231bbe3c8e885103f">IRSOL_LOG_INFO</a></div><div class="ttdeci">#define IRSOL_LOG_INFO(...)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/da9/logging_8hpp_source.html#l00024">logging.hpp:24</a></div></div>
<div class="ttc" id="anamespaceirsol_1_1utils_html_af2468710608c92085f4771001ea3a105"><div class="ttname"><a href="../../d8/d93/namespaceirsol_1_1utils.html#af2468710608c92085f4771001ea3a105">irsol::utils::durationToString</a></div><div class="ttdeci">std::string durationToString(irsol::types::duration_t dr)</div><div class="ttdoc">Converts a duration to a human-readable string.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d06/utils_8cpp_source.html#l00133">utils.cpp:133</a></div></div>
</div><!-- fragment --><h2><code>getExposure</code> and <code>setExposure</code></h2>
<p>Exposure is a time-based parameter, and this abstraction uses <code><a class="el" href="../../d9/d2e/namespaceirsol_1_1types.html#a0775ad5dc200d54581662730e0241ec4">irsol::types::duration_t</a></code> for safe and expressive exposure control. </p><div class="fragment"><div class="line"><a class="code hl_typedef" href="../../d9/d2e/namespaceirsol_1_1types.html#a0775ad5dc200d54581662730e0241ec4">irsol::types::duration_t</a> getExposure() <span class="keyword">const</span>;</div>
<div class="line"><a class="code hl_typedef" href="../../d9/d2e/namespaceirsol_1_1types.html#a0775ad5dc200d54581662730e0241ec4">irsol::types::duration_t</a> setExposure(<a class="code hl_typedef" href="../../d9/d2e/namespaceirsol_1_1types.html#a0775ad5dc200d54581662730e0241ec4">irsol::types::duration_t</a> exposure);</div>
<div class="ttc" id="anamespaceirsol_1_1types_html_a0775ad5dc200d54581662730e0241ec4"><div class="ttname"><a href="../../d9/d2e/namespaceirsol_1_1types.html#a0775ad5dc200d54581662730e0241ec4">irsol::types::duration_t</a></div><div class="ttdeci">clock_t::duration duration_t</div><div class="ttdef"><b>Definition</b> <a href="../../dd/de3/types_8hpp_source.html#l00027">types.hpp:27</a></div></div>
</div><!-- fragment --><ul>
<li><code>getExposure()</code> reads the <code>"ExposureTime"</code> feature (in microseconds) and returns it as a <code><a class="el" href="../../d9/d2e/namespaceirsol_1_1types.html#a0775ad5dc200d54581662730e0241ec4">irsol::types::duration_t</a></code> type.</li>
<li><code>setExposure()</code> sets the exposure time.</li>
</ul>
<p>One should alway prefer to call these methods rather than relying on the raw <code>setParam</code> and <code>getParam</code> methods.</p>
<p>Example usage:</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> exposure = interface.getExposure();</div>
<div class="line">interface.setExposure(std::chrono::milliseconds(15));</div>
</div><!-- fragment --><p>This approach provides type safety and unit clarity when managing exposure values.</p>
<h2><code>setMultiParam</code></h2>
<p>To optimize configuration and avoid repetitive locking and logging, <code>setMultiParam</code> allows batch updates to multiple parameters: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> setMultiParam(<span class="keyword">const</span> std::unordered_map&lt;std::string, camera_param_t&gt;&amp; params);</div>
</div><!-- fragment --><ul>
<li><code>camera_param_t</code> is a variant supporting multiple value types (<code>int</code>, <code>double</code>, <code>std::string</code>, etc.).</li>
<li>This function acquires the mutex once, then updates all parameters in sequence.</li>
<li>It's useful during initialization, resolution setup, or mode switching.</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">interface.setMultiParam({</div>
<div class="line">  {<span class="stringliteral">&quot;BinningVertical&quot;</span>, 2},</div>
<div class="line">  {<span class="stringliteral">&quot;BinningVerticalMode&quot;</span>, <span class="stringliteral">&quot;Average&quot;</span>},</div>
<div class="line">  {<span class="stringliteral">&quot;ExposureAuto&quot;</span>, <span class="stringliteral">&quot;Off&quot;</span>},</div>
<div class="line">  {<span class="stringliteral">&quot;ExposureMode&quot;</span>, <span class="stringliteral">&quot;Timed&quot;</span>}</div>
<div class="line">});</div>
</div><!-- fragment --><p>Using <code>setMultiParam</code> ensures consistency and performance in situations where several related parameters must be updated simultaneously. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
